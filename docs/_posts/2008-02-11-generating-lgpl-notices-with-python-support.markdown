---
author: admin
comments: true
date: 2008-02-11 03:19:00+00:00
layout: post
link: https://rafaelnaufal.com/blog/2008/02/11/generating-lgpl-notices-with-python-support/
slug: generating-lgpl-notices-with-python-support
title: Generating LGPL notices with Python support
wordpress_id: 61
tags:
- java_programming
- jfilecontentmanager
- lgpl
- ooad
- python
---

When we started developing [JFileContentManager](http://rnaufal.livejournal.com/16871.html), we didn't even think to release it as an open-source project. So, when we finished the project, I particularly thought about this idea, because I was very interested in participating on an community involving project. So, we decided to release it under the [LGPL](http://www.gnu.org/licenses/lgpl.html) licence, because we wanted the project audience to be wider as possible.  But, before turning it public, we needed to add the LGPL license term to every [Java](http://java.sun.com/) file of the project.
Opening and editing each Java class, one by one, would be a tedious task, taking a lot of time and adding up to the fact I'm very interested on learning dynamic languages (like [Python](http://www.python.org/), [Ruby](http://www.ruby-lang.org/)), I developed a Python script to automate this task for us. Our Python code is intended to open each Java file, adding the license term on the start of the file as a Java comment and writing it to the disk. The script is as follows:


    
    <span class="gutter"> 1:</span><span class="syntax1">#</span><span class="syntax1"> </span><span class="syntax1">Python</span><span class="syntax1"> </span><span class="syntax1">script</span><span class="syntax1"> </span><span class="syntax1">to</span><span class="syntax1"> </span><span class="syntax1">add</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">LGPL</span><span class="syntax1"> </span><span class="syntax1">notices</span><span class="syntax1"> </span><span class="syntax1">to</span><span class="syntax1"> </span><span class="syntax1">each</span><span class="syntax1"> </span><span class="syntax1">java</span><span class="syntax1"> </span><span class="syntax1">file</span><span class="syntax1"> </span><span class="syntax1">of</span><span class="syntax1"> </span><span class="syntax1">the</span><span class="syntax1"> </span><span class="syntax1">FileContentManager</span><span class="syntax1"> </span><span class="syntax1">project.</span>
    <span class="gutter"> 2:</span><span class="syntax8">import</span> os, glob, sys
    <span class="gutter"> 3:</span>License <span class="syntax18">=</span> <span class="syntax14">"""</span><span class="syntax14">\</span>
    <span class="gutter"> 4:</span><span class="syntax14">/**</span>
    <span class="gutterH"> 5:</span><span class="syntax14">*FileContentManager</span><span class="syntax14"> </span><span class="syntax14">is</span><span class="syntax14"> </span><span class="syntax14">a</span><span class="syntax14"> </span><span class="syntax14">Java</span><span class="syntax14"> </span><span class="syntax14">based</span><span class="syntax14"> </span><span class="syntax14">file</span><span class="syntax14"> </span><span class="syntax14">manager</span><span class="syntax14"> </span><span class="syntax14">desktop</span><span class="syntax14"> </span><span class="syntax14">application,</span><span class="syntax14"> </span>
    <span class="gutter"> 6:</span><span class="syntax14">*it</span><span class="syntax14"> </span><span class="syntax14">can</span><span class="syntax14"> </span><span class="syntax14">show,</span><span class="syntax14"> </span><span class="syntax14">edit</span><span class="syntax14"> </span><span class="syntax14">and</span><span class="syntax14"> </span><span class="syntax14">manipulate</span><span class="syntax14"> </span><span class="syntax14">the</span><span class="syntax14"> </span><span class="syntax14">content</span><span class="syntax14"> </span><span class="syntax14">of</span><span class="syntax14"> </span><span class="syntax14">the</span><span class="syntax14"> </span><span class="syntax14">files</span><span class="syntax14"> </span><span class="syntax14">archived</span><span class="syntax14"> </span><span class="syntax14">inside</span><span class="syntax14"> </span><span class="syntax14">a</span><span class="syntax14"> </span><span class="syntax14">zip.</span>
    <span class="gutter"> 7:</span><span class="syntax14">*</span>
    <span class="gutter"> 8:</span><span class="syntax14">*Copyright</span><span class="syntax14"> </span><span class="syntax14">(C)</span><span class="syntax14"> </span><span class="syntax14">2008</span><span class="syntax14"> </span>
    <span class="gutter"> 9:</span><span class="syntax14">*</span>
    <span class="gutterH">10:</span><span class="syntax14">*Created</span><span class="syntax14"> </span><span class="syntax14">by</span><span class="syntax14"> </span><span class="syntax14">Camila</span><span class="syntax14"> </span><span class="syntax14">Sanchez</span><span class="syntax14"> </span><span class="syntax14">[http://mimix.wordpress.com/],</span><span class="syntax14"> </span><span class="syntax14">Rafael</span><span class="syntax14"> </span><span class="syntax14">Naufal</span><span class="syntax14"> </span><span class="syntax14">[http://rnaufal.livejournal.com]</span><span class="syntax14"> </span>
    <span class="gutter">11:</span><span class="syntax14">and</span><span class="syntax14"> </span><span class="syntax14">Rodrigo</span><span class="syntax14"> </span><span class="syntax14">[rdomartins@gmail.com]</span>
    <span class="gutter">12:</span><span class="syntax14">*</span>
    <span class="gutter">13:</span><span class="syntax14">*FileContentManager</span><span class="syntax14"> </span><span class="syntax14">is</span><span class="syntax14"> </span><span class="syntax14">free</span><span class="syntax14"> </span><span class="syntax14">software;</span><span class="syntax14"> </span><span class="syntax14">you</span><span class="syntax14"> </span><span class="syntax14">can</span><span class="syntax14"> </span><span class="syntax14">redistribute</span><span class="syntax14"> </span><span class="syntax14">it</span><span class="syntax14"> </span><span class="syntax14">and/or</span>
    <span class="gutter">14:</span><span class="syntax14">*modify</span><span class="syntax14"> </span><span class="syntax14">it</span><span class="syntax14"> </span><span class="syntax14">under</span><span class="syntax14"> </span><span class="syntax14">the</span><span class="syntax14"> </span><span class="syntax14">terms</span><span class="syntax14"> </span><span class="syntax14">of</span><span class="syntax14"> </span><span class="syntax14">the</span><span class="syntax14"> </span><span class="syntax14">GNU</span><span class="syntax14"> </span><span class="syntax14">Lesser</span><span class="syntax14"> </span><span class="syntax14">General</span><span class="syntax14"> </span><span class="syntax14">Public</span>
    <span class="gutterH">15:</span><span class="syntax14">*License</span><span class="syntax14"> </span><span class="syntax14">as</span><span class="syntax14"> </span><span class="syntax14">published</span><span class="syntax14"> </span><span class="syntax14">by</span><span class="syntax14"> </span><span class="syntax14">the</span><span class="syntax14"> </span><span class="syntax14">Free</span><span class="syntax14"> </span><span class="syntax14">Software</span><span class="syntax14"> </span><span class="syntax14">Foundation;</span><span class="syntax14"> </span><span class="syntax14">either</span>
    <span class="gutter">16:</span><span class="syntax14">*version</span><span class="syntax14"> </span><span class="syntax14">2.1</span><span class="syntax14"> </span><span class="syntax14">of</span><span class="syntax14"> </span><span class="syntax14">the</span><span class="syntax14"> </span><span class="syntax14">License,</span><span class="syntax14"> </span><span class="syntax14">or</span><span class="syntax14"> </span><span class="syntax14">(at</span><span class="syntax14"> </span><span class="syntax14">your</span><span class="syntax14"> </span><span class="syntax14">option)</span><span class="syntax14"> </span><span class="syntax14">any</span><span class="syntax14"> </span><span class="syntax14">later</span><span class="syntax14"> </span><span class="syntax14">version.</span>
    <span class="gutter">17:</sp><span class="syntax14">*</span>
    <span class="gutter">18:</span><span class="syntax14">*This</span><span class="syntax14"> </span><span class="syntax14">library</span><span class="syntax14"> </span><span class="syntax14">is</span><span class="syntax14"> </span><span class="syntax14">distributed</span><span class="syntax14"> </span><span class="syntax14">in</span><span class="syntax14"> </span><span class="syntax14">the</span><span class="syntax14"> </span><span class="syntax14">hope</span><span class="syntax14"> </span><span class="syntax14">that</span><span class="syntax14"> </span><span class="syntax14">it</span><span class="syntax14"> </span><span class="syntax14">will</span><span class="syntax14"> </span><span class="syntax14">be</span><span class="syntax14"> </span><span class="syntax14">useful,</span>
    <span class="gutter">19:</span><span class="syntax14">*but</span><span class="syntax14"> </span><span class="syntax14">WITHOUT</span><span class="syntax14"> </span><span class="syntax14">ANY</span><span class="syntax14"> </span><span class="syntax14">WARRANTY;</span><span class="syntax14"> </span><span class="syntax14">without</span><span class="syntax14"> </span><span class="syntax14">even</span><span class="syntax14"> </span><span class="syntax14">the</span><span class="syntax14"> </span><span class="syntax14">implied</span><span class="syntax14"> </span><span class="syntax14">warranty</span><span class="syntax14"> </span><span class="syntax14">of</span>
    <span class="gutterH">20:</span><span class="syntax14">*MERCHANTABILITY</span><span class="syntax14"> </span><span class="syntax14">or</span><span class="syntax14"> </span><span class="syntax14">FITNESS</span><span class="syntax14"> </span><span class="syntax14">FOR</span><span class="syntax14"> </span><span class="syntax14">A</span><span class="syntax14"> </span><span class="syntax14">PARTICULAR</span><span class="syntax14"> </span><span class="syntax14">PURPOSE.</span><span class="syntax14"> </span><span class="syntax14">See</span><span class="syntax14"> </span><span class="syntax14">the</span><span class="syntax14"> </span><span class="syntax14">GNU</span>
    <span class="gutter">21:</span><span class="syntax14">*Lesser</span><span class="syntax14"> </span><span class="syntax14">General</span><span class="syntax14"> </span><span class="syntax14">Public</span><span class="syntax14"> </span><span class="syntax14">License</span><span class="syntax14"> </span><span class="syntax14">for</span><span class="syntax14"> </span><span class="syntax14">more</span><span class="syntax14"> </span><span class="syntax14">details.</span>
    <span class="gutter">22:</span><span class="syntax14">*</span>
    <span class="gutter">23:</span><span class="syntax14">*You</span><span class="syntax14"> </span><span class="syntax14">should</span><span class="syntax14"> </span><span class="syntax14">have</span><span class="syntax14"> </span><span class="syntax14">received</span><span class="syntax14"> </span><span class="syntax14">a</span><span class="syntax14"> </span><span class="syntax14">copy</span><span class="syntax14"> </span><span class="syntax14">of</span><span class="syntax14"> </span><span class="syntax14">the</span><span class="syntax14"> </span><span class="syntax14">GNU</span><span class="syntax14"> </span><span class="syntax14">Lesser</span><span class="syntax14"> </span><span class="syntax14">General</span><span class="syntax14"> </span><span class="syntax14">Public</span>
    <span class="gutter">24:</span><span class="syntax14">*License</span><span class="syntax14"> </span><span class="syntax14">along</span><span class="syntax14"> </span><span class="syntax14">with</span><span class="syntax14"> </span><span class="syntax14">FileContentManager;</span><span class="syntax14"> </span><span class="syntax14">if</span><span class="syntax14"> </span><span class="syntax14">not,</span><span class="syntax14"> </span><span class="syntax14">write</span><span class="syntax14"> </span><span class="syntax14">to</span><span class="syntax14"> </span><span class="syntax14">the</span><span class="syntax14"> </span><span class="syntax14">Free</span><span class="syntax14"> </span><span class="syntax14">Software</span>
    <span class="gutterH">25:</span><span class="syntax14">*Foundation,</span><span class="syntax14"> </span><span class="syntax14">Inc.,</span><span class="syntax14"> </span><span class="syntax14">59</span><span class="syntax14"> </span><span class="syntax14">Temple</span><span class="syntax14"> </span><span class="syntax14">Place,</span><span class="syntax14"> </span><span class="syntax14">Suite</span><span class="syntax14"> </span><span class="syntax14">330,</span><span class="syntax14"> </span><span class="syntax14">Boston,</span><span class="syntax14"> </span><span class="syntax14">MA</span><span class="syntax14"> </span><span class="syntax14">02111-1307</span><span class="syntax14"> </span><span class="syntax14">USA</span><span class="syntax14"> </span><span class="syntax14">"""</span>
    <span class="gutter">26:</span>
    <span class="gutter">27:</span>size <span class="syntax18">=</span> <span class="syntax9">len</span>(sys.argv)
    <span class="gutter">28:</span><span class="syntax8">if</span> size <span class="syntax18">=</span><span class="syntax18">=</span> <span class="syntax5">1</span> <span class="syntax8">or</span> size <span class="syntax18">></span> <span class="syntax5">2</span>:
    <span class="gutter">29:</span>    <span class="syntax8">print</span> <span class="syntax13">"</span><span class="syntax13">Usage:</span><span class="syntax13"> </span><span class="syntax13">AddLicense.py</span><span class="syntax13"> </span><span class="syntax13">$1</span><span class="syntax13">"</span>
    <span class="gutterH">30:</span>    sys.<span class="syntax6">exit</span>(<span class="syntax5">1</span>)
    <span class="gutter">31:</span>inputPath <span class="syntax18">=</span> sys.argv[<span class="syntax5">1</span>]
    <span class="gutter">32:</span><span class="syntax8">if</span> <span class="syntax8">not</span> os.path.<span class="syntax6">exists</span>(inputPath):
    <span class="gutter">33:</span>    <span class="syntax8">print</span> inputPath, <span class="syntax13">"</span><span class="syntax13">does</span><span class="syntax13"> </span><span class="syntax13">not</span><span class="syntax13"> </span><span class="syntax13">exist</span><span class="syntax13"> </span><span class="syntax13">on</span><span class="syntax13"> </span><span class="syntax13">disk</span><span class="syntax13">"</span>
    <span class="gutter">34:</span>    sys.<span class="syntax6">exit</span>(<span class="syntax5">1</span>)
    <span class="gutterH">35:</span><span class="syntax8">if</span> <span class="syntax8">not</span> os.path.<span class="syntax6">isdir</span>(inputPath):
    <span class="gutter">36:</span>    <span class="syntax8">print</span> inputPath, <span class="syntax13">"</span><span class="syntax13">isn't</span><span class="syntax13"> </span><span class="syntax13">a</span><span class="syntax13"> </span><span class="syntax13">dir</span><span class="syntax13">"</span>
    <span class="gutter">37:</span>    sys.<span class="syntax6">exit</span>(<span class="syntax5">1</span>)   
    <span class="gutter">38:</span><span class="syntax8">for</span> path, dirs, files <span class="syntax8">in</span> os.<span class="syntax6">walk</span>(inputPath):
    <span class="gutter">39:</span>    fileWithLicense <span class="syntax18">=</span> <span class="syntax13">'</span><span class="syntax13">'</span>
    <span class="gutterH">40:</span>    <span class="syntax8">for</span> filepath <span class="syntax8">in</span> [ os.path.<span class="syntax6">join</span>(path, f)
    <span class="gutter">41:</span>            <span class="syntax8">for</span> f <span class="syntax8">in</span> files <span class="syntax8">if</span> f.<span class="syntax6">endswith</span>(<span class="syntax13">"</span><span class="syntax13">.java</span><span class="syntax13">"</span>)]:
    <span class="gutter">42:</span>        content <span class="syntax18">=</span> <span class="syntax9">file</span>(filepath).<span class="syntax6">read</span>()
    <span class="g
    utter">43:</span>        f <span class="syntax18">=</span> <span class="syntax9">file</span>(filepath, <span class="syntax13">"</span><span class="syntax13">w</span><span class="syntax13">"</span>)
    <span class="gutter">44:</span>        <span class="syntax8">print</span> <span class="syntax18">></span><span class="syntax18">></span>f, License <span class="syntax18">+</span> <span class="syntax13">"</span><span class="syntax13">\n</span><span class="syntax13">"</span> <span class="syntax18">+</span> content
    <span class="gutterH">45:</span>        f.<span class="syntax6">close</span>()
    <span class="gutter">46:</span>        
    <span class="gutter">47:</span>    
    



`License` is a Python multiline string, denoted by the triple-quotes. The main action begins with the `os.walk()` expression that walks every file in the directory, entered by the user as a comannd line argument, like this: 

    
    python AddLicense.py ${path}

where `${path}` defines user project root directory. The list comprehension syntax produces the full path of each of the Java files. When the match is found, the file is opened and its content is assigned to the variable `content`. So, the License string is added to the start of the file and the file is then written to the disk. The print statements use a redirection syntax, for example: `print >>f, License + "\n" + content`. The '>>f' sends the results to `f` rather than the console. So, this Python script helped our team to release the project early and at the same time automated the task of adding the LGPL notices. I think Python is very useful for these kind of tasks. And you?
